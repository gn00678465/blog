---
title: 函式 function
date: 2019-12-16 10:52:14
categories:
- JavaScript
tags:
- Basic
- JavaScript
---
# 什麼是函式
{% asset_img function_1.png 800 %}
「函式」指的是將一或多段程式指令包裝起來，可以重複使用，也方便維護。
**函式是物件的一種**

一個函式會有以下特性：
- 函式是可被呼叫的。
- 函式的名稱 (也可能沒有名稱)。
- 在括號 `( )` 中的部分，稱為「參數 (arguments) 」，參數與參數之間會用逗號 `,` 隔開。
- 在大括號 `{ }` 內的部分，內含需要**重複執行的內容**，是函式功能的主要區塊。

宣告函式的方法
- 具名函式
使用 `function 名稱(參數) { ... };` 的方式
```javascript
function functionA() {
  console.log('具名函式', '函式陳述式');
  console.log(functionA)
}
functionA()
```
{% note no-icon %}
ƒ functionA() {
  console.log('具名函式', '函式陳述式');
  console.log(functionA)
}
{% endnote %}
- 匿名函式
  透過 `變數名稱 = function(參數){ ... };` 的方式，將一個函式透過 `=` 指定給某個變數。
  ```javascript
  var functionB = function () {
    console.log('匿名函式', '函式表達式');
    console.log(functionB)
  }
  functionB()
  ```
  {% note no-icon %}
  ƒ () {
    console.log('匿名函式', '函式表達式');
    console.log(functionB)
  }
  {% endnote %}
  在匿名函式中，如果想要在 function 後面加上一個名字也是可以的，但是要注意的是，這個名字只在「<font color="red">自己函式的區塊內</font>」有效。
  脫離了函式自身區塊後，變數 `functionD` 就不存在了。
  ```javascript
  var functionC = function functionD() {
    console.log(functionC, functionD)
    //具名函式能在函式內被調用
  }
  functionC()
  console.log(functionC)
  console.log(functionD)  //functionD is not defined
  ```
  {% note no-icon %}
  ƒ functionD() {
    console.log(functionC, functionD)
  } ƒ functionD() {
    console.log(functionC, functionD)
  }
  {% endnote %}

  {% tabs 其他範例 %}
<!-- tab -->
```javascript
var num = 1 ;
var giveMeMoney = function giveMoreMoney(coin) {
  num += 1;
  console.log('執行 giveMeMoney', num, coin);
  return coin > 100 ? coin : giveMoreMoney(num*coin);
}
console.log(giveMeMoney(30))
```
{% note no-icon %}
執行 giveMeMoney 2 30
執行 giveMeMoney 3 60
執行 giveMeMoney 4 180
180
{% endnote %}
<!-- endtab -->

<!-- tab -->
```javascript
function callSomeOne(fn) {
  fn()
}
callSomeOne(function() {console.log('執行函式')})
```
{% note no-icon %}
執行函式
{% endnote %}
<!-- endtab -->
{% endtabs %}

- 透過 `new Function` 關鍵字建立函式
使用 `new Function` (<font color="red">注意 F 大寫</font>) 這個關鍵字來建立函式物件。
使用時將參數與函式的內容依序傳入 `Function`
```javascript
// 透過 new 來建立 Function "物件"
var square = new Function('number', 'return number * number');
```
>透過 `new Function` 所建立的函式物件，每次執行時都會進行解析「字串」(如 `'return number * number'` ) 的動作，運作效能較差，所以通常實務上也較少會這樣做。

- 箭頭函式 The arrow function expression (=>)
ES6新增的箭頭函式，使程式碼更為精簡。
將 `function` 改成 `=>` ，並移至 `()` 的後方。
```javascript
Arrow() => {
  console.log('箭頭函式');
};
Arrow
```

# 立即函式(IIFE)

**IIFE**
>IIFE (Immediately Invoked Function Expression) 是一個定義完馬上就執行的 JavaScript function，是一種常見的設計模式。
又可稱為 Self-Executing Anonymous Function。

IIFE包含兩部分
1. 使用 Grouping Operator `()` 包含的匿名函式。
2. 馬上執行 function 的 expression `()`，JavaScript 引擎看到它就會立刻轉譯該 function。
`(function(參數){ ... })()`

特性：
- 定義完立刻就執行
- 無法於函式外再次被執行
  ```javascript
  (function IFFE() {
    console.log('立即函式', IFFE)
  })();
  console.log(IFFE)
  ```
  {% note no-icon%}
  立即函式 ƒ IFFE() {
    console.log('立即函式', IFFE)
  }
  <font color='red'>{% label danger@IFFE is not defined%}</font>
  {% endnote%}
- 限制變數的作用域：{% label primary@function scope 內的變數在外面是無法存取的 %}。
  ```javascript
  (function () {
    var Name = 'IFFE';
    console.log(Name)   //IFFE
  })();
  console.log(Name)     //Name is not defined
  ```
- 可以傳遞參數
  ```javascript
  (function (para) {
    console.log('IFFE' + para)   //IFFE可以傳遞參數
  })('可以傳遞參數');
  // 把 IIFE 設定變數並儲存它的結果
  var result = (function (parameter) {
    return parameter
  })('return IFFE 結果')
  console.log(result)           //return IFFE 結果
  ```
- 須符合ASI規則：因立即函示不包含在ASI的規則內，故於2個函式間須插入 `;` ，否則會出現錯誤。
{% tabs 須符合ASI規則 %}
<!-- tab 錯誤 -->
```javascript
(function () {
})()
(function () {
})()
// (intermediate value)(...) is not a function
```
<!-- endtab -->

<!-- tab 正確 -->
```javascript
(function () {
})();
(function () {
})()
```
<!-- endtab -->
{% endtabs %}
- function間傳遞參數
{% tabs function間傳遞參數 %}
<!-- tab 建立新物件 -->
利用物件傳參考的特性，讓不同的function可以互相傳遞。
```javascript
var a = {};
(function (b) {
  b.parameter = '這是傳遞的變數'
})(a);
(function (c) {
  console.log(c.parameter)    //這是傳遞的變數
})(a)
```
<!-- endtab -->

<!-- tab 全域物件 -->
透過全域物件較常使用在大型框架上，如 [<font color=#41b883>Vue.js</font>](https://vuejs.org)，此方式可以確保框架可以正確的掛載於全域物件上。
```javascript
(function (global) {
  global.parameter = '透過window傳遞變數'
})(window);
(function () {
  console.log(parameter)    //透過window傳遞變數
})()
```
<!-- endtab -->
{% endtabs %}

其它形式
1. JSLint：符合 JSLint 的版本，須將 expression `()` 包進外層的 grouping operator `()` 內。
```javascript
(function () {
}());
```
2. Arrow function：ES6新增的箭頭函式，使程式碼更為精簡，但行為一致。
```javascript
(() => {
})();
```
3. Async function：ES7新增的 `async` ，目前主要為了 top level await 而使用。
```javascript
(async function () {
})();
//搭配箭頭函式
(async () => {
})();
```

# 參數
什麼是參數(parameter)?
參數其實就是我們會帶入函式的變數。
```javascript

```
